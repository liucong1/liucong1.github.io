webpackJsonp([1],{"3e6c":function(t,e){},"9AMr":function(t,e){},COkl:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};s.d(n,"simulateCall",function(){return R}),s.d(n,"call",function(){return N}),s.d(n,"checkHashResult",function(){return S});var a=s("7+uW"),i=s("zL8q"),o=s.n(i),l=(s("tvR6"),{name:"App",created(){"undefined"==typeof webExtensionWallet&&alert("请安装并且登录钱包")},methods:{handleMenuClick(t,e){console.log("menu click: ",t,e),this.$router.push({name:t})}}}),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[this._m(0),this._v(" "),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":this.$route.name,mode:"horizontal"},on:{select:this.handleMenuClick}},[e("el-menu-item",{attrs:{index:"ProductList"}},[this._v("首页")]),this._v(" "),e("el-menu-item",{attrs:{index:"MyList"}},[this._v("我的")])],1),this._v(" "),e("router-view")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"app-title"},[e("span",[this._v("星云体育用品店")])])}]};var c=s("VU/8")(l,r,!1,function(t){s("3e6c")},null,null).exports,u=s("/ocq"),d={name:"ProductList",data:()=>({types:{football:{num:0,img:"https://liucong1.github.io/static/img/nas/football.jpg",name:"足球"},basketball:{num:0,img:"https://liucong1.github.io/static/img/nas/basketball.jpeg",name:"篮球"},pingpang:{num:0,img:"https://liucong1.github.io/static/img/nas/pingpang.jpeg",name:"乒乓球"},badminton:{num:0,img:"https://liucong1.github.io/static/img/nas/badminton.jpeg",name:"羽毛球"},skip:{num:0,img:"https://liucong1.github.io/static/img/nas/tiaosheng.jpg",name:"跳绳"}},isLoad:!0,isAdmin:!1,rentGoods:{idList:[]},dialogRentVisible:!1}),created(){this.fetchList()},methods:{fetchList(){let t=this;const e=this.$loading({lock:!0,text:"正在加载体育用品信息...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.isLoad=!0,this.$api.simulateCall({funcName:"listAllTypes",args:[]}).then(s=>{this.isAdmin=s.isAdmin;let n=s.types;for(let e in n)t.types[e].num=n[e].num,n[e].name&&(t.types[e].name=n[e].name),t.types[e].deposit=n[e].deposit,t.types[e].rent=n[e].rent,t.types[e].idList=n[e].idList;t.isLoad=!1,e.close()}).catch(s=>{e.close(),t.isLoad=!1,t.types=[],t.$message.error("获取商品信息异常，请稍后再试"),console.error(s)})},showRentGoodsDialog(t){this.rentGoods=t,this.dialogRentVisible=!0},confirmRent(t,e){let s=this;this.$api.call({funcName:"rentGoods",args:[t],value:e}).then(t=>{let e=t.txhash,n=this.$loading({lock:!0,text:"正在查询交易结果，请稍后...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});s.$api.checkHashResult(e).then(()=>{s.dialogRentVisible=!1,n.close(),this.$message({message:"商品租赁成功",type:"success"}),s.fetchList()}).catch(t=>{this.$message.error("租赁失败，请稍后再试！"),console.error(t),n.close()})}).catch(t=>{this.$message.error("租赁失败，请稍后再试！"),console.error(t)})}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-box"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isAdmin,expression:"isAdmin"}],staticClass:"admin-box"},[s("span",[t._v("欢迎您，管理员")]),t._v(" "),s("el-button",{staticClass:"btn-enter-goods",attrs:{type:"primary"},on:{click:function(e){t.dialogEnteringVisible=!0}}},[t._v("录入商品")])],1),t._v(" "),s("el-dialog",{attrs:{title:"确认租赁",visible:t.dialogRentVisible,center:""},on:{"update:visible":function(e){t.dialogRentVisible=e}}},[s("div",{staticClass:"dialog-goods-detail-box"},[s("div",{staticClass:"good-info"},[s("span",{staticClass:"desc"},[t._v("商品名：")]),t._v(" "),s("span",{staticClass:"bold"},[t._v(t._s(t.rentGoods.name))])]),t._v(" "),s("div",{staticClass:"good-info"},[s("span",{staticClass:"desc"},[t._v("商品ID：")]),t._v(" "),s("span",{staticClass:"bold"},[t._v(t._s(t.rentGoods.idList[0]))])]),t._v(" "),s("div",{staticClass:"good-info"},[s("span",{staticClass:"desc"},[t._v("商品押金：")]),t._v(" "),s("span",{staticClass:"bold"},[t._v(t._s(t.rentGoods.deposit)+" Wei")])]),t._v(" "),s("div",{staticClass:"good-info"},[s("span",{staticClass:"desc"},[t._v("商品租金：")]),t._v(" "),s("span",{staticClass:"bold"},[t._v(t._s(t.rentGoods.rent)+" Wei/天")])])]),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogRentVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.confirmRent(t.rentGoods.idList[0],t.rentGoods.deposit)}}},[t._v("确 定")])],1)]),t._v(" "),[t.types.length<1?s("div",{staticClass:"no-products-tip"},[t._v(t._s(t.isLoad?"正在载入...":"当前还没有商品可供租赁哦~")+"~")]):s("el-row",{staticClass:"product-list-box",attrs:{gutter:20}},t._l(t.types,function(e,n){return s("el-col",{key:n,staticClass:"product-col",attrs:{span:8}},[s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("div",{staticClass:"img-box"},[s("img",{staticClass:"product-img",attrs:{src:e.img}})]),t._v(" "),s("div",{staticStyle:{padding:"14px"}},[s("h2",[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"bottom clearfix"},[t.isAdmin?[s("el-button",{staticClass:"btn-rent",attrs:{type:"primary",plain:""},on:{click:t.manageGoods}},[t._v("管理")])]:[s("el-button",{staticClass:"btn-rent",attrs:{type:"primary",plain:"",disabled:e.num<=0},on:{click:function(s){t.showRentGoodsDialog(e)}}},[t._v("租赁")])],t._v(" "),s("span",{staticClass:"last-num"},[t._v("剩余数量："),s("em",{staticClass:"num"},[t._v(t._s(e.num))]),t._v(" 个")])],2)])])],1)}))],t._v(" "),s("com-page-rule")],2)},staticRenderFns:[]};var m=s("VU/8")(d,p,!1,function(t){s("iHu2")},"data-v-46cd7990",null).exports,h={name:"MyList",data:()=>({list:[],isLoad:!0}),mounted(){this.fetchMyList()},methods:{fetchMyList(){this.isLoad=!0;this.$api.simulateCall({funcName:"userRentList",args:[]}).then(t=>{console.log("out--------\x3e",t),this.isLoad=!1,t.map(t=>{let e=Math.ceil(((new Date).getTime()-1e3*t.time)/864e5);t.day=e;let s=t.deposit-t.rent*e;return t.lastDeposit=s<0?0:s,t.statusTip="rented"===t.status?"":"已归还",t.showReturnBtn="rented"===t.status,t}),this.list=t,this.$message({message:"已更新租借数据",type:"success"})}).catch(t=>{this.isLoad=!1,this.list=[],this.$message.error("获取数据异常，请稍后再试"),console.error(t)})},returnGoods(t){let e=this;this.$api.call({funcName:"returnGoods",args:[t]}).then(t=>{let s=t.txhash,n=this.$loading({lock:!0,text:"正在查询退还结果，请稍后...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});e.$api.checkHashResult(s).then(()=>{e.dialogRentVisible=!1,n.close(),this.$message({message:"商品退还成功",type:"success"}),e.fetchMyList()}).catch(t=>{this.$message.error("退还操作失败，请稍后再试！"),console.error(t),n.close()})}).catch(t=>{this.$message.error("退还失败，请稍后再试！"),console.error(t)})}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-list-box"},[t.list.length<1?s("p",{staticClass:"loading-tip"},[t._v(t._s(t.isLoad?"正在加载数据...":"您暂时还没有租借记录"))]):[s("el-table",{staticStyle:{width:"800px",margin:"30px auto","text-align":"center"},attrs:{data:t.list,border:"",stripe:"",center:"all"}},[s("el-table-column",{attrs:{prop:"goodsId",label:"商品编号","header-align":"center"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"物品名",sortable:"","header-align":"center"}}),t._v(" "),s("el-table-column",{attrs:{label:"起租日期","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(new Date(1e3*e.row.time).toLocaleString())+"\n                ")]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"使用时间","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.day)+"天\n                ")]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"租金结余","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.lastDeposit)+" Wei\n                ")]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"returnTime",label:"归还时间","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(e.row.returnTime?new Date(1e3*e.row.returnTime).toLocaleString():"--")+"\n                ")]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"状态","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.showReturnBtn?s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(s){t.returnGoods(e.row.id)}}},[t._v("归还")]):s("span",[t._v(t._s(e.row.statusTip))])]}}])})],1)],t._v(" "),s("com-page-rule")],2)},staticRenderFns:[]};var v=s("VU/8")(h,g,!1,function(t){s("9AMr")},"data-v-af560c84",null).exports;a.default.use(u.a);var _=new u.a({routes:[{path:"/",name:"ProductList",component:m},{path:"/myList",name:"MyList",component:v}]}),f=s("NYxO"),b=s("6fn7"),y=s.n(b),C=s("uotZ"),w=s("7t+N"),L=s.n(w);let x="https://mainnet.nebulas.io",k="n1mvwBireDRLrLFQzjXcCF3Q3pcAwcHF86Q";console.log(`contract addr: ${k}`);const $=new y.a;function R(t){const e=t.funcName,s=JSON.stringify(t.args||[]);return new Promise((t,n)=>{$.simulateCall(k,"0",e,s,{listener:function(s){console.log(`simulateCall [${e}] 返回结果：`,s),s.result?t(JSON.parse(s.result)):("insufficient balance"===s.execute_err&&i.Notification.warning({title:"钱包报错",message:"您的账户余额不足，请充值后再进行操作",duration:0}),n(s))}})})}function N(t){const e=t.funcName,s=JSON.stringify(t.args||[]),n=new C.BigNumber(t.value||"0").div(1e18).toString();return new Promise((t,a)=>{$.call(k,n,e,s,{listener:function(s){console.log(`call [${e}] 返回结果：`,s),"string"==typeof s&&0===s.indexOf("Error:")?a(new Error(s)):t(s)}})})}function S(t){var e=x+"/v1/user/getTransactionReceipt",s={hash:t};s=JSON.stringify(s);let n=null;return new Promise(function(t,a){n=setInterval(function(){L.a.ajax({type:"POST",url:e,data:s,dataType:"json"}).then(function(e){console.log(22,e),e&&e.result&&(1===e.result.status?(t(),clearInterval(n)):0===e.result.status&&(a(),clearInterval(n)))})},2e3)})}a.default.use(f.a);var A=new f.a.Store({state:{isLoading:!1},mutations:{},actions:{}}),G={name:"com-page-rule",data:()=>({})},E={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("dl",{staticClass:"com-page-rule-box"},[s("dt",[t._v("使用说明")]),t._v(" "),s("dd",[t._v("1、只要你有星云钱包并且有足够的余额即可在店里面租借体育用品，钱包安装地址："),s("a",{attrs:{href:"https://github.com/ChengOrangeJu/WebExtensionWallet"}},[t._v("WebExtensionWallet")]),t._v("、"),s("a",{attrs:{href:"https://nano.nebulas.io/index_cn.html"}},[t._v("Android")]),t._v("、"),s("a",{attrs:{href:"https://itunes.apple.com/hk/app/nas-nano/id1281191905?l=zh&ls=1&mt=8"}},[t._v("iOS")]),t._v("；")]),t._v(" "),s("dd",[t._v("2、每一项体育用品都有押金和租金，选择相应的体育用品，点击租赁，支付相应的押金后即可使用；")]),t._v(" "),s("dd",[t._v("3、在”我的“的菜单中可以查询目前已经借用的体育用品列表信息，也可以点击归还按钮就行归还。归还的时候会自动根据使用时间从押金中扣除（如果扣除金额大于押金金额则余额为0），剩余的金额会自动返回用户的钱包中；")]),t._v(" "),s("dd",[t._v("4、使用过程中，如果遇到问题，请"),s("a",{attrs:{href:"https://github.com/liucong1/liucong1.github.io/issues",title:"点击联系工作人员"}},[t._v("联系我们的工作人员")]),t._v("。")]),t._v(" "),s("dd",{staticClass:"copy-right"},[s("a",{attrs:{href:"https://nebulas.io/"}},[t._v("本产品由星云链驱动")]),t._v(" | "),s("a",{attrs:{href:"https://github.com/liucong1/liucong1.github.io/issues"}},[t._v("联系作者")]),t._v(" | "),s("a",{attrs:{href:"https://incentive.nebulas.io/cn/signup.html?invite=KpJAr"}},[t._v("提交DAPP获得100NAS币")])])])}]};var M=s("VU/8")(G,E,!1,function(t){s("COkl")},"data-v-9644cf02",null).exports;a.default.config.productionTip=!1,a.default.use(o.a),a.default.component(M.name,M),a.default.prototype.$api=n,new a.default({el:"#app",router:_,store:A,components:{App:c},template:"<App/>"})},iHu2:function(t,e){},tvR6:function(t,e){}},["NHnr"]);